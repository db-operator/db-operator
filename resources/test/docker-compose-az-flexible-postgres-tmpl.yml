version: "3.8"
services:
  postgres:
    image: ${IMAGE}
    ports:
      - "5432:5432"
    environment:
      POSTGRES_PASSWORD: "test1234"
      POSTGRES_USER: "az_admin"
    volumes:
      - ./resources/test/az_flexible_postgres_init.sh:/docker-entrypoint-initdb.d/az_init.sh
      - data:/usr/share/postgresql
  extension-mark:
    image: alpine
    volumes:
      - data:/usr/share/postgresql
    command:
      - sh
      - -c
      - sleep 10 && echo "trusted = true" >> "$(find /usr/ | grep uuid-ossp.control)"
    depends_on:
      - postgres
volumes:
  data:
